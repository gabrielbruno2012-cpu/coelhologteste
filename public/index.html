<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Financeiro - CoelhoLog</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="login-container">
        <h1>Portal Financeiro - CoelhoLog</h1>

        <input id="email" type="email" placeholder="Digite seu e-mail">
        <input id="senha" type="password" placeholder="Digite sua senha">

        <button onclick="login()">Entrar</button>

        <p id="erro" style="color:red; text-align:center; margin-top:10px;"></p>
    </div>

<script>
async function login() {
    const email = document.getElementById("email").value.trim();
    const senha = document.getElementById("senha").value.trim();
    const erro = document.getElementById("erro");
    erro.innerText = "";

    if (!email || !senha) {
        erro.innerText = "Preencha todos os campos.";
        return;
    }

    try {
        const response = await fetch("/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, senha })
        });

        if (!response.ok) {
            erro.innerText = "Erro ao conectar ao servidor!";
            return;
        }

        const result = await response.json();

        if (!result.success) {
            erro.innerText = "Credenciais inv치lidas!";
            return;
        }

        // Salva dados do usu치rio
        localStorage.setItem("userEmail", result.user.email);
        localStorage.setItem("userRole", result.user.role);

        // REDIRECIONAMENTO CORRIGIDO
        if (result.user.role === "admin" || result.user.role === "financeiro") {
            window.location.href = "/admin/dashboard.html";
        } else if (result.user.role === "colaborador") {
            window.location.href = "/colaborador/dashboard.html";
        } else {
            erro.innerText = "Tipo de usu치rio inv치lido!";
        }

    } catch (err) {
        console.error("Erro no login:", err);
        erro.innerText = "Erro ao conectar com servidor!";
    }
}
</script>

<style>
body {
    font-family: Arial, sans-serif;
    background: #062143;
    margin: 0;
    padding: 0;
}

.login-container {
    width: 400px;
    background: #042B59;
    padding: 25px;
    margin: 100px auto;
    border-radius: 10px;
    text-align: center;
    color: white;
}

.login-container input {
    width: 90%;
    padding: 12px;
    margin: 10px 0;
    border-radius: 6px;
    border: none;
}

.login-container button {
    width: 95%;
    padding: 12px;
    background: #FFC400;
    border: none;
    color: #000;
    font-weight: bold;
    cursor: pointer;
    border-radius: 6px;
}
</style>

</body>
</html>
